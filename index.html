<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.7.5
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>XCoder</h1>

<p>A ruby wrapper around various xcode tools and project, schemes and workspace configuration files</p>

<h2>Example Usage</h2>

<p>You will need to install the gem:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_xcoder'>xcoder</span>
</code></pre>

<p>and then require the gem in your project/rakefile/etc</p>

<pre class="code ruby"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>xcoder</span><span class='tstring_end'>'</span></span>
</code></pre>

<h3>Load a project</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_project'>project</span> <span class='op'>=</span> <span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_project'>project</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>MyProject</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>  <span class='comment'># Can be the name, the file (e.g. MyProject.xcodeproj) or the path
</span></code></pre>

<h3>Finding all projects from the current directory down</h3>

<pre class="code ruby"><code><span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_find_projects'>find_projects</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span>
</code></pre>

<h3>Find a configuration for a target on a project</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_project'>project</span><span class='lparen'>(</span><span class='symbol'>:MyProject</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span><span class='lparen'>(</span><span class='symbol'>:Target</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='lparen'>(</span><span class='symbol'>:Debug</span><span class='rparen'>)</span>   <span class='comment'># returns an Xcode::Configuration object
</span></code></pre>

<h3>Building a configuration</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span> <span class='op'>=</span> <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_builder'>builder</span>
<span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_profile'>profile</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Profiles/MyAdHoc.mobileprovision</span><span class='tstring_end'>'</span></span>    <span class='comment'># This will remove old profiles and install the profile
</span><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_identity'>identity</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>iPhone Developer: Ray Hilton</span><span class='tstring_end'>'</span></span>       <span class='comment'># The name of the identity to use to sign the IPA (optional)
</span><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span>
</code></pre>

<h3>Working with Keychains</h3>

<p>You will not normally need to worry about manipulating keychains unless you want to automate importing of certificates (in a CI system with many clients) or opening of specific keychains for different builds (the old two-certs-with-same-identity-name workaround).</p>

<p>You can either use the user&#39;s login keychain, another named keychain, or simply use a temporary keychain that will be blown away after the build.</p>

<h4>Creating a temporary keychain</h4>

<pre class="code ruby"><code><span class='const'>Xcode</span><span class='op'>::</span><span class='const'>Keychain</span><span class='period'>.</span><span class='id identifier rubyid_temp_keychain'>temp_keychain</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ProjectKeychain.keychain</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_keychain'>keychain</span><span class='op'>|</span>
    <span class='comment'># import certs into the keychain
</span>    <span class='comment'># perform builds within this keychain's context
</span><span class='kw'>end</span> <span class='comment'># Keychain is deleted
</span></code></pre>

<h4>Importing a certificate</h4>

<p>You can import a certificate from a .p12 file into a keychain.  Here we simply create a temporary keychain, import a certificate, set the identity onto the builder and then perform a build.</p>

<pre class="code ruby"><code><span class='id identifier rubyid_keychain'>keychain</span><span class='period'>.</span><span class='id identifier rubyid_import'>import</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Certs/MyCert.p12</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>mycertpassword</span><span class='tstring_end'>'</span></span>        
<span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_keychain'>keychain</span> <span class='op'>=</span> <span class='id identifier rubyid_keychain'>keychain</span>                     <span class='comment'># Tell the builder to use the temp keychain
</span><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_identity'>identity</span> <span class='op'>=</span> <span class='id identifier rubyid_keychain'>keychain</span><span class='period'>.</span><span class='id identifier rubyid_identities'>identities</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>    <span class='comment'># Get the first (only) identity name from the keychain
</span></code></pre>

<h3>Packaging a built .app</h3>

<p>After performing the above build, you can create a versioned, well named .ipa and .dSYM.zip</p>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_package'>package</span>
</code></pre>

<p>This will produce something like: MyProject-Debug-1.0.ipa and MyProject-Debug-1.0.dSYM.zip</p>

<h3>Incrementing the build number</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_info_plist'>info_plist</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_info'>info</span><span class='op'>|</span>
  <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>+</span> <span class='int'>1</span>
  <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
<span class='kw'>end</span>
</code></pre>

<h3>Working with workspaces</h3>

<p>Loading workspaces can be done in a similar way to projects:</p>

<pre class="code ruby"><code><span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_workspaces'>workspaces</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_w'>w</span><span class='op'>|</span>
  <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_describe'>describe</span>                                <span class='comment'># prints a recursive description of the 
</span>                                            <span class='comment'># structure of the workspace and its projects
</span><span class='kw'>end</span>
</code></pre>

<p>Or, if you know the name:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_workspace'>workspace</span> <span class='op'>=</span> <span class='const'>Xcode</span><span class='period'>.</span><span class='id identifier rubyid_workspace'>workspace</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>MyWorkspace</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>  <span class='comment'># Can be the name, the file (e.g. MyWorkspace.xcworkspace) or the path
</span></code></pre>

<h3>Schemes</h3>

<p>There is basic support for schemes, you can enumerate them from a project like so:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_schemes'>schemes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span>
<span class='kw'>end</span>
</code></pre>

<p>Or, access them by name:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_scheme'>scheme</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>MyScheme</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_builder'>builder</span>
</code></pre>

<p>Note: The builder behaves the same as the builder for the target/config approach and will force xcodebuild to use the local build/ directory (as per xcode3) rather than a generated temporary directory in DerivedData.  This may or may not be a good thing.</p>

<p>Note: Shared schemes and user (current logged in user) specific schemes are both loaded. They may share names and other similarities that make them hard to distinguish. Currently the priority loading order is shared schemes and then user specific schemes.</p>

<h3>Provisioning profiles</h3>

<p>The library provides a mechanism to install/uninstall a provisioning profile.  This normally happens as part of a build (if a profile is provided to the builder, see above), but you can do this manually:</p>

<pre class="code ruby"><code><span class='const'>Xcode</span><span class='op'>::</span><span class='const'>ProvisioningProfile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Myprofile.mobileprovision</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_install'>install</span> <span class='comment'># installs profile into ~/Library
</span></code></pre>

<p>Or enumerate installed profiles:</p>

<pre class="code ruby"><code><span class='const'>Xcode</span><span class='op'>::</span><span class='const'>ProvisioningProfile</span><span class='period'>.</span><span class='id identifier rubyid_installed_profiles'>installed_profiles</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span>
    <span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_uninstall'>uninstall</span>     <span class='comment'># Removes the profile from ~/Library/
</span><span class='kw'>end</span>
</code></pre>

<h3>Testflight</h3>

<p>The common output of this build/package process is to upload to testflight.  This is pretty simple with xcoder:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_testflight'>testflight</span><span class='lparen'>(</span><span class='const'>API_TOKEN</span><span class='comma'>,</span> <span class='const'>TEAM_TOKEN</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tf'>tf</span><span class='op'>|</span>
  <span class='id identifier rubyid_tf'>tf</span><span class='period'>.</span><span class='id identifier rubyid_notes'>notes</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>some release notes</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_tf'>tf</span><span class='period'>.</span><span class='id identifier rubyid_notify'>notify</span> <span class='op'>=</span> <span class='kw'>true</span>  <span class='comment'># Whether to send a notification to users, default is true
</span>  <span class='id identifier rubyid_tf'>tf</span><span class='period'>.</span><span class='id identifier rubyid_lists'>lists</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AList</span><span class='tstring_end'>&quot;</span></span>  <span class='comment'># The lists to distribute the build to
</span><span class='kw'>end</span>
</code></pre>

<p>You can also optionally set a .proxy= property or just set the HTTP_PROXY environment variable.</p>

<h3>OCUnit to JUnit reports</h3>

<p>You can invoke your test target/bundle from the builder</p>

<pre class="code ruby"><code><span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_test'>test</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_report'>report</span><span class='op'>|</span>
    <span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>test-reports</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:junit</span>
<span class='kw'>end</span>
</code></pre>

<p>This will invoke the test target, capture the output and write the junit reports to the test-reports directory.  Currently only junit is supported.</p>

<h2>Tests</h2>

<p>There are some basic RSpec tests in the project which I suspect /wont/ work on machines without my identity installed.  </p>

<p>Currently these tests only assert the basic project file parsing and build code and do not perform file modification tests (e.g. for info plists) or provisioning profile/keychain importing</p>

<h2>Feedback</h2>

<p>Please raise issues if you find defects or have a feature request.  </p>
</div></div>
    
    <div id="footer">
  Generated on Mon Feb 13 23:50:09 2012 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.5 (ruby-1.9.2).
</div>

  </body>
</html>